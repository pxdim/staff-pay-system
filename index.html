<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ¶å¤–LEDé›»è¦–ç‰†å°ˆæ¥­è¨ˆç®—æ©Ÿ - ç§Ÿè³ƒ/æ¡è³¼é›™æ¨¡å¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeInDown 0.6s ease;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .mode-badge {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-weight: 600;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            animation: fadeInUp 0.8s ease;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .card-title {
            font-size: 1.4em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            font-size: 1.2em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 0.95em;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        input[type="number"], select {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .unit {
            color: #777;
            font-weight: 500;
            white-space: nowrap;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #555;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .result-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .result-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .result-item:hover {
            transform: scale(1.02);
        }

        .result-label {
            font-size: 0.85em;
            color: #777;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-value {
            font-size: 1.5em;
            color: #333;
            font-weight: 700;
        }

        .result-value.highlight {
            color: #667eea;
        }

        .visual-preview {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            text-align: center;
        }

        .led-grid {
            display: inline-grid;
            gap: 2px;
            padding: 20px;
            background: #333;
            border-radius: 10px;
            margin-top: 15px;
        }

        .led-panel {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            border-radius: 2px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .info-box h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .info-box ul {
            list-style: none;
            color: #856404;
        }

        .info-box ul li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .info-box ul li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .advanced-settings {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .toggle-advanced {
            cursor: pointer;
            color: #667eea;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-advanced:hover {
            color: #764ba2;
        }

        .advanced-content {
            margin-top: 20px;
            display: none;
        }

        .advanced-content.show {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        .cost-section {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .cost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .cost-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .cost-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .cost-value {
            font-size: 1.3em;
            font-weight: 700;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .export-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 15px 25px;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(67, 233, 123, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(67, 233, 123, 0.4);
        }

        .rental-highlight {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            padding: 15px;
            border-radius: 10px;
            color: white;
            margin-bottom: 20px;
        }

        .rental-highlight h3 {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ–¥ï¸ æˆ¶å¤–LEDé›»è¦–ç‰†å°ˆæ¥­è¨ˆç®—æ©Ÿ</h1>
            <p>ç²¾ç¢ºè¨ˆç®—LEDé›»è¦–ç‰†å°ºå¯¸ã€æ¨¡çµ„æ•¸é‡ã€ç·šæéœ€æ±‚åŠæˆæœ¬é ä¼°</p>
            <div class="mode-badge" id="modeBadge">æ¡è³¼æ¨¡å¼</div>
        </div>

        <div class="main-grid">
            <!-- è¼¸å…¥å€åŸŸ -->
            <div class="card">
                <h2 class="card-title">
                    <span class="icon">ğŸ“</span>
                    åŸºæœ¬åƒæ•¸è¨­å®š
                </h2>
                
                <div class="input-group">
                    <label>æ¥­å‹™æ¨¡å¼</label>
                    <select id="businessMode" onchange="switchBusinessMode()">
                        <option value="purchase">æ¡è³¼æ¨¡å¼</option>
                        <option value="rental">ç§Ÿè³ƒæ¨¡å¼</option>
                    </select>
                </div>

                <div id="rentalOptions" style="display:none;">
                    <div class="rental-highlight">
                        <h3>ğŸª ç§Ÿè³ƒå°ˆå±¬è¨­å®š</h3>
                        <div class="input-group">
                            <label>ç§Ÿè³ƒå¤©æ•¸</label>
                            <div class="input-wrapper">
                                <input type="number" id="rentalDays" value="3" min="1">
                                <span class="unit">å¤©</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>å¿«é€Ÿé¸æ“‡å¸¸ç”¨è¦æ ¼</label>
                            <select id="quickSpec" onchange="applyQuickSpec()">
                                <option value="">-- è‡ªå®šç¾© --</option>
                                <option value="p2.6">P2.6 å®¤å…§ (500Ã—500mm)</option>
                                <option value="p3.91">P3.91 å®¤å…§/æˆ¶å¤– (500Ã—500mm)</option>
                                <option value="p4.81">P4.81 æˆ¶å¤– (500Ã—500mm)</option>
                                <option value="p6.25">P6.25 æˆ¶å¤– (500Ã—500mm)</option>
                                <option value="p2.976">P2.976 å®¤å…§ (500Ã—500mm)</option>
                                <option value="p3.91-250">P3.91 å®¤å…§ (250Ã—250mm)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>è¢å¹•å°è§’ç·šå°ºå¯¸</label>
                    <div class="input-wrapper">
                        <input type="number" id="screenSize" value="300" min="1" max="9999">
                        <span class="unit">å‹</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>é•·å¯¬æ¯”ä¾‹</label>
                    <select id="aspectRatio">
                        <option value="16:9">16:9 (æ¨™æº–)</option>
                        <option value="21:9">21:9 (è¶…å¯¬)</option>
                        <option value="4:3">4:3 (å‚³çµ±)</option>
                        <option value="custom">è‡ªå®šç¾©</option>
                    </select>
                </div>

                <div id="customRatio" style="display:none;">
                    <div class="input-group">
                        <label>è‡ªå®šç¾©æ¯”ä¾‹</label>
                        <div class="input-wrapper">
                            <input type="number" id="customWidth" value="16" min="1">
                            <span class="unit">:</span>
                            <input type="number" id="customHeight" value="9" min="1">
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>å–®ç‰‡LEDæ¨¡çµ„å°ºå¯¸</label>
                    <div class="input-wrapper">
                        <input type="number" id="panelWidth" value="500" min="1">
                        <span class="unit">mm Ã—</span>
                        <input type="number" id="panelHeight" value="500" min="1">
                        <span class="unit">mm</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>
                        <span class="tooltip">
                            åƒç´ é–“è· (Pixel Pitch)
                            <span class="tooltiptext">åƒç´ é–“è·è¶Šå°ï¼Œè§£æåº¦è¶Šé«˜ï¼Œé©åˆè¿‘è·é›¢è§€çœ‹ã€‚æˆ¶å¤–é€šå¸¸ä½¿ç”¨6-10mm</span>
                        </span>
                    </label>
                    <div class="input-wrapper">
                        <input type="number" id="pixelPitch" value="8" min="0.1" max="50" step="0.1">
                        <span class="unit">mm</span>
                    </div>
                </div>

                <div class="advanced-settings">
                    <div class="toggle-advanced" onclick="toggleAdvanced()">
                        <span>âš™ï¸</span>
                        <span>é€²éšè¨­å®š</span>
                        <span id="advancedArrow">â–¼</span>
                    </div>
                    <div id="advancedContent" class="advanced-content">
                        <div class="input-group">
                            <label>å–®ç‰‡æ¨¡çµ„åŠŸè€—</label>
                            <div class="input-wrapper">
                                <input type="number" id="panelPower" value="50" min="1">
                                <span class="unit">W</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>äº®åº¦</label>
                            <div class="input-wrapper">
                                <input type="number" id="brightness" value="6500" min="1000" max="10000" step="500">
                                <span class="unit">cd/mÂ²</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>åˆ·æ–°ç‡</label>
                            <div class="input-wrapper">
                                <select id="refreshRate">
                                    <option value="1920">1920Hz</option>
                                    <option value="3840" selected>3840Hz</option>
                                    <option value="7680">7680Hz</option>
                                </select>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>æ§åˆ¶å¡è² è¼‰èƒ½åŠ›</label>
                            <div class="input-wrapper">
                                <input type="number" id="controlCardCapacity" value="655360" min="1">
                                <span class="unit">åƒç´ </span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>æ¥æ”¶å¡ç¶²å£æ•¸é‡</label>
                            <div class="input-wrapper">
                                <input type="number" id="receiverPorts" value="2" min="1" max="16">
                                <span class="unit">å€‹</span>
                            </div>
                        </div>
                        
                        <h4 style="margin-top: 25px; margin-bottom: 15px; color: #667eea; border-top: 2px solid #e0e0e0; padding-top: 20px;">ğŸ’° æˆæœ¬åƒæ•¸è¨­å®š</h4>
                        
                        <div id="purchaseCostParams">
                            <div class="input-group">
                                <label>LEDæ¨¡çµ„å–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="panelUnitPrice" value="2000" min="1">
                                    <span class="unit">NT$/ç‰‡</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>ç™¼é€å¡å–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="senderCardPrice" value="5000" min="1">
                                    <span class="unit">NT$/å¼µ</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>æ¥æ”¶å¡å–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="receiverCardPrice" value="800" min="1">
                                    <span class="unit">NT$/å¼µ</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>ç¶²è·¯ç·šå–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="networkCablePrice" value="200" min="1">
                                    <span class="unit">NT$/æ¢</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>é›»æºç·šå–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="powerCablePrice" value="500" min="1">
                                    <span class="unit">NT$/æ¢</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>é‹¼æ§‹å–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="structurePrice" value="3000" min="1">
                                    <span class="unit">NT$/mÂ²</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>å®‰è£äººå·¥å–®åƒ¹</label>
                                <div class="input-wrapper">
                                    <input type="number" id="laborPrice" value="1500" min="1">
                                    <span class="unit">NT$/mÂ²</span>
                                </div>
                            </div>
                        </div>
                        
                        <div id="rentalCostParams" style="display:none;">
                            <div class="input-group">
                                <label>LEDæ¨¡çµ„ç§Ÿé‡‘</label>
                                <div class="input-wrapper">
                                    <input type="number" id="panelRentalPrice" value="2000" min="1">
                                    <span class="unit">NT$/ç‰‡/å¤©</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>é‹è¼¸è²»ç”¨</label>
                                <div class="input-wrapper">
                                    <input type="number" id="transportPrice" value="20000" min="0">
                                    <span class="unit">NT$ (ä¾†å›)</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>å®‰è£æ‹†å¸è²»</label>
                                <div class="input-wrapper">
                                    <input type="number" id="installPrice" value="500" min="0">
                                    <span class="unit">NT$/mÂ²</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>æŠ€è¡“äººå“¡è²»</label>
                                <div class="input-wrapper">
                                    <input type="number" id="technicianPrice" value="8000" min="0">
                                    <span class="unit">NT$/äºº/å¤©</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>éœ€è¦æŠ€è¡“äººå“¡æ•¸</label>
                                <div class="input-wrapper">
                                    <input type="number" id="technicianCount" value="2" min="0">
                                    <span class="unit">äºº</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>è¨­å‚™ä¿éšªè²»ç‡</label>
                                <div class="input-wrapper">
                                    <input type="number" id="insuranceRate" value="3" min="0" max="100" step="0.1">
                                    <span class="unit">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="calculate()">è¨ˆç®—</button>
                    <button class="btn btn-secondary" onclick="reset()">é‡ç½®</button>
                </div>
            </div>

            <!-- çµæœå€åŸŸ -->
            <div class="card">
                <h2 class="card-title">
                    <span class="icon">ğŸ“Š</span>
                    è¨ˆç®—çµæœ
                </h2>

                <div id="results" style="display:none;">
                    <!-- å°ºå¯¸çµæœ -->
                    <div class="result-section">
                        <h3 style="margin-bottom: 15px; color: #333;">ğŸ“ å¯¦éš›å°ºå¯¸</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">å¯¦éš›å¯¬åº¦</div>
                                <div class="result-value highlight" id="actualWidth">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å¯¦éš›é«˜åº¦</div>
                                <div class="result-value highlight" id="actualHeight">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">ç¸½é¢ç©</div>
                                <div class="result-value" id="totalArea">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å°è§’ç·š</div>
                                <div class="result-value" id="diagonal">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- æ¨¡çµ„çµæœ -->
                    <div class="result-section">
                        <h3 style="margin-bottom: 15px; color: #333;">ğŸ”² æ¨¡çµ„é…ç½®</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">æ©«å‘æ¨¡çµ„æ•¸</div>
                                <div class="result-value highlight" id="panelsWide">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">ç¸±å‘æ¨¡çµ„æ•¸</div>
                                <div class="result-value highlight" id="panelsHigh">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">ç¸½æ¨¡çµ„æ•¸</div>
                                <div class="result-value" id="totalPanels">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å‚™ç”¨æ¨¡çµ„(5%)</div>
                                <div class="result-value" id="sparePanels">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- è§£æåº¦çµæœ -->
                    <div class="result-section">
                        <h3 style="margin-bottom: 15px; color: #333;">ğŸ–¼ï¸ è§£æåº¦èˆ‡åƒç´ </h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">æ°´å¹³è§£æåº¦</div>
                                <div class="result-value" id="horizontalRes">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å‚ç›´è§£æåº¦</div>
                                <div class="result-value" id="verticalRes">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">ç¸½åƒç´ æ•¸</div>
                                <div class="result-value highlight" id="totalPixels">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">åƒç´ å¯†åº¦</div>
                                <div class="result-value" id="pixelDensity">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- ç·šæèˆ‡é›»åŠ›çµæœ -->
                    <div class="result-section">
                        <h3 style="margin-bottom: 15px; color: #333;">ğŸ”Œ ç·šæèˆ‡é›»åŠ›éœ€æ±‚</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">ä¸»ç¶²è·¯ç·šæ•¸</div>
                                <div class="result-value highlight" id="networkCables">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">é›»æºç·šæ•¸</div>
                                <div class="result-value highlight" id="powerCables">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">ç¸½åŠŸè€—</div>
                                <div class="result-value" id="totalPower">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å»ºè­°é›»æº</div>
                                <div class="result-value" id="suggestedPower">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- æ§åˆ¶ç³»çµ± -->
                    <div class="result-section">
                        <h3 style="margin-bottom: 15px; color: #333;">ğŸ® æ§åˆ¶ç³»çµ±</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">ç™¼é€å¡æ•¸é‡</div>
                                <div class="result-value" id="senderCards">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">æ¥æ”¶å¡æ•¸é‡</div>
                                <div class="result-value" id="receiverCards">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">è¦–é »è™•ç†å™¨</div>
                                <div class="result-value" id="videoProcessor">-</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">æ§åˆ¶é›»è…¦</div>
                                <div class="result-value" id="controlPC">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- æˆæœ¬ä¼°ç®— -->
                    <div class="cost-section">
                        <h3 style="margin-bottom: 15px;">ğŸ’° æˆæœ¬ä¼°ç®— (åƒè€ƒ)</h3>
                        <div class="cost-grid">
                            <div class="cost-item">
                                <div class="cost-label" id="cost-label-1">LEDæ¨¡çµ„</div>
                                <div class="cost-value" id="panelCost">-</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-label" id="cost-label-2">æ§åˆ¶ç³»çµ±</div>
                                <div class="cost-value" id="controlCost">-</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-label" id="cost-label-3">ç·šæé…ä»¶</div>
                                <div class="cost-value" id="cableCost">-</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-label" id="cost-label-4">å®‰è£çµæ§‹</div>
                                <div class="cost-value" id="structureCost">-</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-label" id="cost-label-5">äººå·¥å®‰è£</div>
                                <div class="cost-value" id="laborCost">-</div>
                            </div>
                            <div class="cost-item">
                                <div class="cost-label">ç¸½è¨ˆä¼°ç®—</div>
                                <div class="cost-value" id="totalCost" style="font-size: 1.5em;">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- è¦–è¦ºé è¦½ -->
                    <div class="visual-preview">
                        <h3 style="margin-bottom: 10px; color: #333;">ğŸ¨ æ¨¡çµ„æ’åˆ—é è¦½</h3>
                        <div id="ledGridPreview"></div>
                        <p style="margin-top: 15px; color: #666; font-size: 0.9em;">
                            æ¯å€‹æ–¹å¡Šä»£è¡¨ä¸€å€‹LEDæ¨¡çµ„
                        </p>
                    </div>

                    <!-- å»ºè­°è³‡è¨Š -->
                    <div class="info-box">
                        <h4>ğŸ’¡ å°ˆæ¥­å»ºè­°</h4>
                        <ul id="suggestions">
                            <!-- å‹•æ…‹ç”Ÿæˆå»ºè­° -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="export-btn" onclick="exportResults()">ğŸ“¥ åŒ¯å‡ºå ±å‘Š</button>

    <script>
        // åˆ‡æ›æ¥­å‹™æ¨¡å¼
        function switchBusinessMode() {
            const mode = document.getElementById('businessMode').value;
            const rentalOptions = document.getElementById('rentalOptions');
            const purchaseCostParams = document.getElementById('purchaseCostParams');
            const rentalCostParams = document.getElementById('rentalCostParams');
            const modeBadge = document.getElementById('modeBadge');
            
            if (mode === 'rental') {
                rentalOptions.style.display = 'block';
                if (purchaseCostParams) purchaseCostParams.style.display = 'none';
                if (rentalCostParams) rentalCostParams.style.display = 'block';
                modeBadge.textContent = 'ç§Ÿè³ƒæ¨¡å¼';
                modeBadge.style.background = 'rgba(255, 216, 155, 0.5)';
            } else {
                rentalOptions.style.display = 'none';
                if (purchaseCostParams) purchaseCostParams.style.display = 'block';
                if (rentalCostParams) rentalCostParams.style.display = 'none';
                modeBadge.textContent = 'æ¡è³¼æ¨¡å¼';
                modeBadge.style.background = 'rgba(255, 255, 255, 0.3)';
            }
        }

        // å¥—ç”¨å¿«é€Ÿè¦æ ¼
        function applyQuickSpec() {
            const spec = document.getElementById('quickSpec').value;
            const specs = {
                'p2.6': { pitch: 2.6, width: 500, height: 500 },
                'p3.91': { pitch: 3.91, width: 500, height: 500 },
                'p4.81': { pitch: 4.81, width: 500, height: 500 },
                'p6.25': { pitch: 6.25, width: 500, height: 500 },
                'p2.976': { pitch: 2.976, width: 500, height: 500 },
                'p3.91-250': { pitch: 3.91, width: 250, height: 250 }
            };
            
            if (spec && specs[spec]) {
                document.getElementById('pixelPitch').value = specs[spec].pitch;
                document.getElementById('panelWidth').value = specs[spec].width;
                document.getElementById('panelHeight').value = specs[spec].height;
            }
        }

        // åˆ‡æ›é€²éšè¨­å®š
        function toggleAdvanced() {
            const content = document.getElementById('advancedContent');
            const arrow = document.getElementById('advancedArrow');
            
            if (content.classList.contains('show')) {
                content.classList.remove('show');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('show');
                arrow.textContent = 'â–²';
            }
        }

        // ç›£è½é•·å¯¬æ¯”é¸æ“‡
        document.getElementById('aspectRatio').addEventListener('change', function() {
            const customRatio = document.getElementById('customRatio');
            if (this.value === 'custom') {
                customRatio.style.display = 'block';
            } else {
                customRatio.style.display = 'none';
            }
        });

        // è¨ˆç®—å‡½æ•¸
        function calculate() {
            // ç²å–è¼¸å…¥å€¼
            const screenSize = parseFloat(document.getElementById('screenSize').value);
            const aspectRatioSelect = document.getElementById('aspectRatio').value;
            const panelWidth = parseFloat(document.getElementById('panelWidth').value);
            const panelHeight = parseFloat(document.getElementById('panelHeight').value);
            const pixelPitch = parseFloat(document.getElementById('pixelPitch').value);
            const panelPower = parseFloat(document.getElementById('panelPower').value);
            const brightness = parseFloat(document.getElementById('brightness').value);
            const refreshRate = parseFloat(document.getElementById('refreshRate').value);
            const controlCardCapacity = parseFloat(document.getElementById('controlCardCapacity').value);
            const receiverPorts = parseFloat(document.getElementById('receiverPorts').value);
            const businessMode = document.getElementById('businessMode').value;

            // è¨ˆç®—é•·å¯¬æ¯”
            let ratioWidth, ratioHeight;
            if (aspectRatioSelect === 'custom') {
                ratioWidth = parseFloat(document.getElementById('customWidth').value);
                ratioHeight = parseFloat(document.getElementById('customHeight').value);
            } else {
                const ratios = {
                    '16:9': [16, 9],
                    '21:9': [21, 9],
                    '4:3': [4, 3]
                };
                [ratioWidth, ratioHeight] = ratios[aspectRatioSelect];
            }

            // è¨ˆç®—å¯¦éš›å°ºå¯¸ï¼ˆè‹±å¯¸è½‰æ¯«ç±³ï¼‰
            const inchToMm = 25.4;
            const diagonal = screenSize * inchToMm;
            const ratio = ratioWidth / ratioHeight;
            const height = Math.sqrt(diagonal * diagonal / (1 + ratio * ratio));
            const width = height * ratio;

            // è¨ˆç®—éœ€è¦çš„æ¨¡çµ„æ•¸é‡
            const panelsWide = Math.ceil(width / panelWidth);
            const panelsHigh = Math.ceil(height / panelHeight);
            const totalPanels = panelsWide * panelsHigh;
            const sparePanels = Math.ceil(totalPanels * 0.05);

            // è¨ˆç®—å¯¦éš›å°ºå¯¸
            const actualWidth = panelsWide * panelWidth;
            const actualHeight = panelsHigh * panelHeight;
            const totalArea = (actualWidth * actualHeight) / 1000000; // å¹³æ–¹ç±³

            // è¨ˆç®—è§£æåº¦
            const horizontalRes = Math.floor(actualWidth / pixelPitch);
            const verticalRes = Math.floor(actualHeight / pixelPitch);
            const totalPixels = horizontalRes * verticalRes;
            const pixelDensity = Math.round(totalPixels / totalArea);

            // è¨ˆç®—ç·šæéœ€æ±‚
            const networkCables = Math.ceil(totalPixels / controlCardCapacity);
            const powerCables = Math.ceil(totalPanels / 4); // å‡è¨­æ¯4å€‹æ¨¡çµ„ä¸€æ¢é›»æºç·š
            const totalPower = totalPanels * panelPower;
            const suggestedPower = Math.ceil(totalPower * 1.3 / 1000) * 1000; // ç•™30%é¤˜é‡

            // è¨ˆç®—æ§åˆ¶ç³»çµ±
            const senderCards = networkCables;
            const receiverCards = Math.ceil(totalPanels / receiverPorts);
            const videoProcessor = totalPixels > 2073600 ? "4Kè™•ç†å™¨" : "2Kè™•ç†å™¨";
            const controlPC = totalPixels > 8294400 ? "é«˜é…å·¥ä½œç«™" : "æ¨™æº–æ§åˆ¶é›»è…¦";

            // æˆæœ¬ä¼°ç®—
            let panelCost, controlCost, cableCost, structureCost, laborCost, totalCost;
            
            if (businessMode === 'rental') {
                // ç§Ÿè³ƒæ¨¡å¼è¨ˆç®—
                const rentalDays = parseFloat(document.getElementById('rentalDays').value) || 3;
                const panelRentalPrice = parseFloat(document.getElementById('panelRentalPrice').value) || 2000;
                const transportPrice = parseFloat(document.getElementById('transportPrice').value) || 20000;
                const installPrice = parseFloat(document.getElementById('installPrice').value) || 500;
                const technicianPrice = parseFloat(document.getElementById('technicianPrice').value) || 8000;
                const technicianCount = parseFloat(document.getElementById('technicianCount').value) || 2;
                const insuranceRate = parseFloat(document.getElementById('insuranceRate').value) || 3;
                
                panelCost = totalPanels * panelRentalPrice * rentalDays;
                const transportCost = transportPrice;
                const installationCost = totalArea * installPrice * 2; // å®‰è£+æ‹†å¸
                const technicianCost = technicianPrice * technicianCount * rentalDays;
                const insuranceCost = panelCost * (insuranceRate / 100);
                
                // ç§Ÿè³ƒæ¨¡å¼ä¸‹çš„é¡¯ç¤ºèª¿æ•´
                document.getElementById('panelCost').textContent = `NT$ ${panelCost.toLocaleString()}`;
                document.getElementById('controlCost').textContent = `NT$ ${transportCost.toLocaleString()}`;
                document.getElementById('cableCost').textContent = `NT$ ${installationCost.toLocaleString()}`;
                document.getElementById('structureCost').textContent = `NT$ ${technicianCost.toLocaleString()}`;
                document.getElementById('laborCost').textContent = `NT$ ${insuranceCost.toLocaleString()}`;
                
                // æ›´æ–°æ¨™ç±¤æ–‡å­—
                document.getElementById('cost-label-1').textContent = `ç§Ÿé‡‘(${rentalDays}å¤©)`;
                document.getElementById('cost-label-2').textContent = 'é‹è¼¸è²»ç”¨';
                document.getElementById('cost-label-3').textContent = 'å®‰è£æ‹†å¸';
                document.getElementById('cost-label-4').textContent = 'æŠ€è¡“äººå“¡';
                document.getElementById('cost-label-5').textContent = 'è¨­å‚™ä¿éšª';
                
                totalCost = panelCost + transportCost + installationCost + technicianCost + insuranceCost;
            } else {
                // æ¡è³¼æ¨¡å¼è¨ˆç®—
                const panelUnitPrice = parseFloat(document.getElementById('panelUnitPrice').value);
                const senderCardPrice = parseFloat(document.getElementById('senderCardPrice').value);
                const receiverCardPrice = parseFloat(document.getElementById('receiverCardPrice').value);
                const networkCablePrice = parseFloat(document.getElementById('networkCablePrice').value);
                const powerCablePrice = parseFloat(document.getElementById('powerCablePrice').value);
                const structurePrice = parseFloat(document.getElementById('structurePrice').value);
                const laborPrice = parseFloat(document.getElementById('laborPrice').value);
                
                panelCost = totalPanels * panelUnitPrice;
                controlCost = senderCards * senderCardPrice + receiverCards * receiverCardPrice;
                cableCost = (networkCables * networkCablePrice + powerCables * powerCablePrice);
                structureCost = totalArea * structurePrice;
                laborCost = totalArea * laborPrice;
                totalCost = panelCost + controlCost + cableCost + structureCost + laborCost;
                
                // æ¢å¾©åŸå§‹æ¨™ç±¤
                document.getElementById('cost-label-1').textContent = 'LEDæ¨¡çµ„';
                document.getElementById('cost-label-2').textContent = 'æ§åˆ¶ç³»çµ±';
                document.getElementById('cost-label-3').textContent = 'ç·šæé…ä»¶';
                document.getElementById('cost-label-4').textContent = 'å®‰è£çµæ§‹';
                document.getElementById('cost-label-5').textContent = 'äººå·¥å®‰è£';
                
                document.getElementById('panelCost').textContent = `NT$ ${panelCost.toLocaleString()}`;
                document.getElementById('controlCost').textContent = `NT$ ${controlCost.toLocaleString()}`;
                document.getElementById('cableCost').textContent = `NT$ ${cableCost.toLocaleString()}`;
                document.getElementById('structureCost').textContent = `NT$ ${structureCost.toLocaleString()}`;
                document.getElementById('laborCost').textContent = `NT$ ${laborCost.toLocaleString()}`;
            }

            // æ›´æ–°é¡¯ç¤ºçµæœ
            document.getElementById('actualWidth').textContent = `${(actualWidth/1000).toFixed(2)} m`;
            document.getElementById('actualHeight').textContent = `${(actualHeight/1000).toFixed(2)} m`;
            document.getElementById('totalArea').textContent = `${totalArea.toFixed(2)} mÂ²`;
            document.getElementById('diagonal').textContent = `${(Math.sqrt(actualWidth*actualWidth + actualHeight*actualHeight)/inchToMm).toFixed(1)} å‹`;

            document.getElementById('panelsWide').textContent = panelsWide;
            document.getElementById('panelsHigh').textContent = panelsHigh;
            document.getElementById('totalPanels').textContent = totalPanels;
            document.getElementById('sparePanels').textContent = sparePanels;

            document.getElementById('horizontalRes').textContent = `${horizontalRes} px`;
            document.getElementById('verticalRes').textContent = `${verticalRes} px`;
            document.getElementById('totalPixels').textContent = totalPixels.toLocaleString();
            document.getElementById('pixelDensity').textContent = `${pixelDensity.toLocaleString()} px/mÂ²`;

            document.getElementById('networkCables').textContent = `${networkCables} æ¢`;
            document.getElementById('powerCables').textContent = `${powerCables} æ¢`;
            document.getElementById('totalPower').textContent = `${(totalPower/1000).toFixed(1)} kW`;
            document.getElementById('suggestedPower').textContent = `${(suggestedPower/1000).toFixed(0)} kW`;

            document.getElementById('senderCards').textContent = senderCards;
            document.getElementById('receiverCards').textContent = receiverCards;
            document.getElementById('videoProcessor').textContent = videoProcessor;
            document.getElementById('controlPC').textContent = controlPC;

            document.getElementById('totalCost').textContent = `NT$ ${totalCost.toLocaleString()}`;

            // ç”Ÿæˆè¦–è¦ºé è¦½
            generateVisualPreview(panelsWide, panelsHigh);

            // ç”Ÿæˆå»ºè­°
            generateSuggestions(pixelPitch, totalArea, totalPixels, brightness, businessMode);

            // é¡¯ç¤ºçµæœ
            document.getElementById('results').style.display = 'block';
        }

        // ç”Ÿæˆè¦–è¦ºé è¦½
        function generateVisualPreview(wide, high) {
            const preview = document.getElementById('ledGridPreview');
            const maxDisplay = 20; // æœ€å¤šé¡¯ç¤º20x20
            const displayWide = Math.min(wide, maxDisplay);
            const displayHigh = Math.min(high, maxDisplay);
            
            let gridHtml = `<div class="led-grid" style="grid-template-columns: repeat(${displayWide}, 1fr);">`;
            
            for (let i = 0; i < displayWide * displayHigh; i++) {
                gridHtml += '<div class="led-panel"></div>';
            }
            
            gridHtml += '</div>';
            
            if (wide > maxDisplay || high > maxDisplay) {
                gridHtml += `<p style="margin-top: 10px; color: #999; font-size: 0.85em;">
                    (é è¦½é¡¯ç¤º ${displayWide}Ã—${displayHigh}ï¼Œå¯¦éš›ç‚º ${wide}Ã—${high})
                </p>`;
            }
            
            preview.innerHTML = gridHtml;
        }

        // ç”Ÿæˆå»ºè­°
        function generateSuggestions(pixelPitch, area, pixels, brightness, mode) {
            const suggestions = document.getElementById('suggestions');
            let suggestionList = [];

            // æ ¹æ“šåƒç´ é–“è·å»ºè­°è§€çœ‹è·é›¢
            const minDistance = pixelPitch * 1;
            const optimalDistance = pixelPitch * 3;
            suggestionList.push(`å»ºè­°è§€çœ‹è·é›¢ï¼š${minDistance.toFixed(1)}-${optimalDistance.toFixed(1)}å…¬å°º`);

            if (mode === 'rental') {
                // ç§Ÿè³ƒæ¨¡å¼ç‰¹å®šå»ºè­°
                suggestionList.push('ç§Ÿè³ƒå‰è«‹ç¢ºèªå ´åœ°é›»æºå®¹é‡æ˜¯å¦è¶³å¤ ');
                suggestionList.push('å»ºè­°æå‰é€²è¡Œå ´åœ°å‹˜å¯Ÿï¼Œç¢ºèªå®‰è£æ¢ä»¶');
                suggestionList.push('æ´»å‹•ç•¶å¤©å»ºè­°å®‰æ’æŠ€è¡“äººå“¡ç¾å ´å¾…å‘½');
                suggestionList.push('ç§Ÿè³ƒè¨­å‚™å»ºè­°è³¼è²·ä¿éšªï¼Œé¿å…æ„å¤–æå¤±');
                suggestionList.push('ç¢ºèªé‹è¼¸è»Šè¼›å¯é€²å…¥å ´åœ°');
            } else {
                // æ¡è³¼æ¨¡å¼å»ºè­°
                if (area > 50) {
                    suggestionList.push('å¤§å‹é¡¯ç¤ºå±å»ºè­°é…ç½®UPSä¸æ–·é›»ç³»çµ±');
                    suggestionList.push('å»ºè­°å®‰è£ç’°å¢ƒç›£æ¸¬ç³»çµ±ï¼ˆæº«åº¦ã€æ¿•åº¦ã€äº®åº¦æ„Ÿæ‡‰ï¼‰');
                }
                suggestionList.push('å»ºè­°æ¯å­£åº¦é€²è¡Œä¸€æ¬¡å°ˆæ¥­ç¶­è­·ä¿é¤Š');
                suggestionList.push('é ç•™5%å‚™ç”¨æ¨¡çµ„ä»¥æ‡‰å°æ•…éšœæ›´æ›');
            }

            // æ ¹æ“šè§£æåº¦å»ºè­°
            if (pixels > 2073600) {
                suggestionList.push('æ”¯æ´4Kå…§å®¹æ’­æ”¾ï¼Œå»ºè­°ä½¿ç”¨å°ˆæ¥­ç´šè¦–é »è™•ç†å™¨');
            }

            // æ ¹æ“šäº®åº¦å»ºè­°
            if (brightness >= 6000) {
                suggestionList.push('é«˜äº®åº¦è¨­è¨ˆé©åˆæˆ¶å¤–ä½¿ç”¨ï¼Œå»ºè­°åŠ è£è‡ªå‹•äº®åº¦èª¿ç¯€ç³»çµ±');
            }

            // æ›´æ–°å»ºè­°åˆ—è¡¨
            suggestions.innerHTML = suggestionList.map(s => `<li>${s}</li>`).join('');
        }

        // é‡ç½®åŠŸèƒ½
        function reset() {
            // é‡ç½®åŸºæœ¬åƒæ•¸
            document.getElementById('screenSize').value = 300;
            document.getElementById('aspectRatio').value = '16:9';
            document.getElementById('panelWidth').value = 500;
            document.getElementById('panelHeight').value = 500;
            document.getElementById('pixelPitch').value = 8;
            document.getElementById('businessMode').value = 'purchase';
            
            // é‡ç½®ç§Ÿè³ƒåƒæ•¸
            if (document.getElementById('rentalDays')) {
                document.getElementById('rentalDays').value = 3;
            }
            
            // é‡ç½®é€²éšåƒæ•¸
            document.getElementById('panelPower').value = 50;
            document.getElementById('brightness').value = 6500;
            document.getElementById('refreshRate').value = '3840';
            document.getElementById('controlCardCapacity').value = 655360;
            document.getElementById('receiverPorts').value = 2;
            
            // é‡ç½®æˆæœ¬åƒæ•¸
            document.getElementById('panelUnitPrice').value = 2000;
            document.getElementById('senderCardPrice').value = 5000;
            document.getElementById('receiverCardPrice').value = 800;
            document.getElementById('networkCablePrice').value = 200;
            document.getElementById('powerCablePrice').value = 500;
            document.getElementById('structurePrice').value = 3000;
            document.getElementById('laborPrice').value = 1500;
            
            // é‡ç½®ç§Ÿè³ƒæˆæœ¬åƒæ•¸
            if (document.getElementById('panelRentalPrice')) {
                document.getElementById('panelRentalPrice').value = 2000;
                document.getElementById('transportPrice').value = 20000;
                document.getElementById('installPrice').value = 500;
                document.getElementById('technicianPrice').value = 8000;
                document.getElementById('technicianCount').value = 2;
                document.getElementById('insuranceRate').value = 3;
            }
            
            // éš±è—çµæœå’Œè‡ªå®šç¾©æ¯”ä¾‹
            document.getElementById('results').style.display = 'none';
            document.getElementById('customRatio').style.display = 'none';
            document.getElementById('rentalOptions').style.display = 'none';
            switchBusinessMode();
        }

        // åŒ¯å‡ºå ±å‘Š
        function exportResults() {
            if (document.getElementById('results').style.display === 'none') {
                alert('è«‹å…ˆé€²è¡Œè¨ˆç®—');
                return;
            }

            const businessMode = document.getElementById('businessMode').value;
            const modeText = businessMode === 'rental' ? 'ç§Ÿè³ƒ' : 'æ¡è³¼';
            
            const results = {
                æ¨¡å¼: modeText,
                å°ºå¯¸: {
                    å¯¦éš›å¯¬åº¦: document.getElementById('actualWidth').textContent,
                    å¯¦éš›é«˜åº¦: document.getElementById('actualHeight').textContent,
                    ç¸½é¢ç©: document.getElementById('totalArea').textContent,
                    å°è§’ç·š: document.getElementById('diagonal').textContent
                },
                æ¨¡çµ„é…ç½®: {
                    æ©«å‘æ¨¡çµ„æ•¸: document.getElementById('panelsWide').textContent,
                    ç¸±å‘æ¨¡çµ„æ•¸: document.getElementById('panelsHigh').textContent,
                    ç¸½æ¨¡çµ„æ•¸: document.getElementById('totalPanels').textContent,
                    å‚™ç”¨æ¨¡çµ„: document.getElementById('sparePanels').textContent
                },
                è§£æåº¦: {
                    æ°´å¹³è§£æåº¦: document.getElementById('horizontalRes').textContent,
                    å‚ç›´è§£æåº¦: document.getElementById('verticalRes').textContent,
                    ç¸½åƒç´ æ•¸: document.getElementById('totalPixels').textContent,
                    åƒç´ å¯†åº¦: document.getElementById('pixelDensity').textContent
                },
                ç·šæèˆ‡é›»åŠ›: {
                    ä¸»ç¶²è·¯ç·šæ•¸: document.getElementById('networkCables').textContent,
                    é›»æºç·šæ•¸: document.getElementById('powerCables').textContent,
                    ç¸½åŠŸè€—: document.getElementById('totalPower').textContent,
                    å»ºè­°é›»æº: document.getElementById('suggestedPower').textContent
                },
                æˆæœ¬ä¼°ç®—: {}
            };
            
            // æ ¹æ“šæ¨¡å¼å°å‡ºä¸åŒçš„æˆæœ¬é …ç›®
            if (businessMode === 'rental') {
                const rentalDays = document.getElementById('rentalDays').value;
                results.ç§Ÿè³ƒå¤©æ•¸ = rentalDays + ' å¤©';
                results.æˆæœ¬ä¼°ç®— = {
                    [`ç§Ÿé‡‘(${rentalDays}å¤©)`]: document.getElementById('panelCost').textContent,
                    é‹è¼¸è²»ç”¨: document.getElementById('controlCost').textContent,
                    å®‰è£æ‹†å¸: document.getElementById('cableCost').textContent,
                    æŠ€è¡“äººå“¡: document.getElementById('structureCost').textContent,
                    è¨­å‚™ä¿éšª: document.getElementById('laborCost').textContent,
                    ç¸½è¨ˆ: document.getElementById('totalCost').textContent
                };
            } else {
                results.æˆæœ¬ä¼°ç®— = {
                    LEDæ¨¡çµ„: document.getElementById('panelCost').textContent,
                    æ§åˆ¶ç³»çµ±: document.getElementById('controlCost').textContent,
                    ç·šæé…ä»¶: document.getElementById('cableCost').textContent,
                    å®‰è£çµæ§‹: document.getElementById('structureCost').textContent,
                    äººå·¥å®‰è£: document.getElementById('laborCost').textContent,
                    ç¸½è¨ˆ: document.getElementById('totalCost').textContent
                };
            }

            const text = JSON.stringify(results, null, 2);
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `LEDé›»è¦–ç‰†${modeText}è¨ˆç®—å ±å‘Š_${new Date().toLocaleDateString()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•è¨ˆç®—ä¸€æ¬¡
        window.onload = function() {
            calculate();
        };
    </script>
</body>
</html>
